{"version":3,"sources":["webpack:///./src/components/user/Users.vue?a2a4","webpack:///src/components/user/Users.vue","webpack:///./src/components/user/Users.vue?86b4","webpack:///./src/components/user/Users.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","path","_v","on","getUserList","model","value","queryInfo","callback","$$v","$set","expression","slot","$event","dialogVisible","userList","scopedSlots","_u","key","fn","scope","handleswitch","$index","row","showEditDialog","id","staticClass","handleDelete","handleSetting","pagenum","pagesize","total","handleSizeChange","handleCurrentChange","addDialogClose","ref","addForm","addFormRules","addUser","editDialogVisible","editDialogClose","editForm","editUser","roleDialogVisible","closeRoleDialog","_s","currentUserInfo","username","role_name","selectedRoleID","_l","item","roleName","saveRole","staticRenderFns","data","checkEmail","regEmail","test","Error","checkMobile","regMobile","query","switchValue","allRoles","password","email","mobile","editFormRules","created","methods","$refs","editFormRef","validate","resetFields","addFormRef","newSize","newPage","$confirm","confirmButtonText","cancelButtonText","type","component"],"mappings":"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","file":"js/chunk-2d0b2cfa.c5809346.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: \"/home\" }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"用户管理\")]),_c('el-breadcrumb-item',[_vm._v(\"用户列表\")])],1),_c('el-card',[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"请输入...\"},on:{\"clear\":_vm.getUserList},model:{value:(_vm.queryInfo.query),callback:function ($$v) {_vm.$set(_vm.queryInfo, \"query\", $$v)},expression:\"queryInfo.query\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.getUserList},slot:\"append\"})],1)],1),_c('el-col',{attrs:{\"span\":4}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.dialogVisible=true}}},[_vm._v(\"添加用户\")])],1)],1),_c('el-table',{attrs:{\"data\":_vm.userList,\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"type\":\"index\"}}),_c('el-table-column',{attrs:{\"label\":\"姓名\",\"prop\":\"username\"}}),_c('el-table-column',{attrs:{\"label\":\"邮箱\",\"prop\":\"email\"}}),_c('el-table-column',{attrs:{\"label\":\"电话\",\"prop\":\"mobile\"}}),_c('el-table-column',{attrs:{\"label\":\"角色\",\"prop\":\"role_name\"}}),_c('el-table-column',{attrs:{\"label\":\"状态\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-switch',{on:{\"change\":function($event){return _vm.handleswitch(scope.$index, scope.row)}},model:{value:(scope.row.mg_state),callback:function ($$v) {_vm.$set(scope.row, \"mg_state\", $$v)},expression:\"scope.row.mg_state\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.showEditDialog(scope.row.id)}}},[_c('i',{staticClass:\"el-icon-edit\"})]),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope.row.id)}}},[_c('i',{staticClass:\"el-icon-delete\"})]),_c('el-tooltip',{attrs:{\"enterable\":false,\"effect\":\"dark\",\"content\":\"设置角色\",\"placement\":\"top\"}},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"warning\"},on:{\"click\":function($event){return _vm.handleSetting(scope.row)}}},[_c('i',{staticClass:\"el-icon-setting\"})])],1)]}}])})],1),_c('el-pagination',{attrs:{\"current-page\":_vm.queryInfo.pagenum,\"page-sizes\":[1, 2, 5, 10],\"page-size\":_vm.queryInfo.pagesize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1),_c('el-dialog',{attrs:{\"title\":\"添加用户\",\"visible\":_vm.dialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event},\"close\":_vm.addDialogClose}},[_c('el-form',{ref:\"addFormRef\",attrs:{\"label-width\":\"70px\",\"model\":_vm.addForm,\"rules\":_vm.addFormRules}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"prop\":\"username\"}},[_c('el-input',{model:{value:(_vm.addForm.username),callback:function ($$v) {_vm.$set(_vm.addForm, \"username\", $$v)},expression:\"addForm.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"prop\":\"password\"}},[_c('el-input',{model:{value:(_vm.addForm.password),callback:function ($$v) {_vm.$set(_vm.addForm, \"password\", $$v)},expression:\"addForm.password\"}})],1),_c('el-form-item',{attrs:{\"label\":\"邮箱\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.addForm.email),callback:function ($$v) {_vm.$set(_vm.addForm, \"email\", $$v)},expression:\"addForm.email\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机\",\"prop\":\"mobile\"}},[_c('el-input',{model:{value:(_vm.addForm.mobile),callback:function ($$v) {_vm.$set(_vm.addForm, \"mobile\", $$v)},expression:\"addForm.mobile\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible=false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addUser}},[_vm._v(\"确定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"修改用户信息\",\"visible\":_vm.editDialogVisible,\"width\":\"50%\"},on:{\"close\":_vm.editDialogClose,\"update:visible\":function($event){_vm.editDialogVisible=$event}}},[_c('el-form',{ref:\"editFormRef\",attrs:{\"rules\":_vm.addFormRules,\"model\":_vm.editForm,\"label-width\":\"70px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\"}},[_c('el-input',{attrs:{\"disabled\":\"\"},model:{value:(_vm.editForm.username),callback:function ($$v) {_vm.$set(_vm.editForm, \"username\", $$v)},expression:\"editForm.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"邮箱\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.editForm.email),callback:function ($$v) {_vm.$set(_vm.editForm, \"email\", $$v)},expression:\"editForm.email\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机\",\"prop\":\"mobile\"}},[_c('el-input',{model:{value:(_vm.editForm.mobile),callback:function ($$v) {_vm.$set(_vm.editForm, \"mobile\", $$v)},expression:\"editForm.mobile\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.editDialogVisible=false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editUser}},[_vm._v(\"确定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"分配角色\",\"visible\":_vm.roleDialogVisible,\"width\":\"50%\"},on:{\"close\":_vm.closeRoleDialog,\"update:visible\":function($event){_vm.roleDialogVisible=$event}}},[_c('div',[_c('p',[_vm._v(\"当前的用户: \"+_vm._s(_vm.currentUserInfo.username))]),_c('p',[_vm._v(\"当前的角色: \"+_vm._s(_vm.currentUserInfo.role_name))]),_c('el-select',{attrs:{\"placeholder\":\"请选择...\"},model:{value:(_vm.selectedRoleID),callback:function ($$v) {_vm.selectedRoleID=$$v},expression:\"selectedRoleID\"}},_vm._l((_vm.allRoles),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.roleName,\"value\":item.id}})}),1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.roleDialogVisible=false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveRole}},[_vm._v(\"确定\")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to='{ path: \"/home\" }'>首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>用户管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>用户列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <el-card>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-input @clear='getUserList' clearable v-model='queryInfo.query' placeholder=\"请输入...\">\r\n            <el-button @click='getUserList' slot=\"append\" icon=\"el-icon-search\"></el-button>\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <el-button @click=\"dialogVisible=true\" type=\"primary\">添加用户</el-button>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-table :data=\"userList\" stripe>\r\n         <el-table-column type='index'></el-table-column>\r\n        <el-table-column label=\"姓名\" prop=\"username\"></el-table-column>\r\n        <el-table-column label=\"邮箱\" prop=\"email\"></el-table-column>\r\n        <el-table-column label=\"电话\" prop=\"mobile\"></el-table-column>\r\n        <el-table-column label=\"角色\" prop=\"role_name\"></el-table-column>\r\n        <el-table-column label=\"状态\">\r\n          <template slot-scope=\"scope\">\r\n            <el-switch v-model='scope.row.mg_state' @change=\"handleswitch(scope.$index, scope.row)\"></el-switch>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size='mini' type='primary' @click=\"showEditDialog(scope.row.id)\">\r\n              <i class=\"el-icon-edit\"></i>\r\n            </el-button>\r\n            <el-button size='mini' type='danger' @click=\"handleDelete(scope.row.id)\">\r\n              <i class=\"el-icon-delete\"></i>\r\n            </el-button>\r\n            <el-tooltip :enterable='false' effect='dark' content='设置角色' placement='top'>\r\n              <el-button size='mini' type='warning' @click=\"handleSetting(scope.row)\">\r\n              <i class=\"el-icon-setting\"></i>\r\n            </el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <el-pagination @size-change='handleSizeChange'\r\n       @current-change='handleCurrentChange'\r\n        :current-page='queryInfo.pagenum' :page-sizes='[1, 2, 5, 10]'\r\n         :page-size='queryInfo.pagesize' layout='total, sizes, prev, pager, next, jumper'\r\n          :total='total'>\r\n      </el-pagination>\r\n    </el-card>\r\n\r\n    <el-dialog title='添加用户'\r\n     :visible.sync='dialogVisible' width='50%'\r\n     @close='addDialogClose'>\r\n     <el-form ref='addFormRef' label-width='70px' :model='addForm' :rules='addFormRules'>\r\n        <el-form-item label='名称' prop='username'>\r\n          <el-input v-model='addForm.username'></el-input>\r\n        </el-form-item>\r\n        <el-form-item label='密码' prop='password'>\r\n          <el-input v-model='addForm.password'></el-input>\r\n        </el-form-item>\r\n        <el-form-item label='邮箱' prop='email'>\r\n          <el-input v-model='addForm.email'></el-input>\r\n        </el-form-item>\r\n        <el-form-item label='手机' prop='mobile'>\r\n          <el-input v-model='addForm.mobile'></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot='footer' class='dialog-footer'>\r\n        <el-button @click='dialogVisible=false'>取消</el-button>\r\n        <el-button type='primary' @click='addUser'>确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <el-dialog title='修改用户信息' @close='editDialogClose'\r\n    :visible.sync='editDialogVisible' width='50%'>\r\n      <el-form :rules='addFormRules' ref='editFormRef' :model='editForm' label-width='70px'>\r\n        <el-form-item label='用户名'>\r\n          <el-input disabled v-model='editForm.username'></el-input>\r\n        </el-form-item>\r\n        <el-form-item label='邮箱' prop='email'>\r\n          <el-input v-model='editForm.email'></el-input>\r\n        </el-form-item>\r\n        <el-form-item label='手机' prop='mobile'>\r\n          <el-input v-model='editForm.mobile'></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot='footer' class='dialog-footer'>\r\n        <el-button @click='editDialogVisible=false'>取消</el-button>\r\n        <el-button type='primary' @click=\"editUser\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n      <!-- 分配角色 -->\r\n    <el-dialog title='分配角色' @close='closeRoleDialog'\r\n     :visible.sync='roleDialogVisible' width='50%'\r\n     >\r\n     <div>\r\n       <p>当前的用户: {{ currentUserInfo.username }}</p>\r\n       <p>当前的角色: {{ currentUserInfo.role_name }}</p>\r\n       <el-select v-model=\"selectedRoleID\" placeholder=\"请选择...\">\r\n        <el-option\r\n         v-for=\"item in allRoles\"\r\n         :key=\"item.id\"\r\n         :label=\"item.roleName\"\r\n         :value=\"item.id\">\r\n        </el-option>\r\n      </el-select>\r\n     </div>\r\n      <span slot='footer' class='dialog-footer'>\r\n        <el-button @click='roleDialogVisible=false'>取消</el-button>\r\n        <el-button @click=\"saveRole\" type='primary'>确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    var checkEmail = (rule, value, callback) => {\r\n      const regEmail = /^[a-zA0-9_-]+@([a-zA-Z0-9_-])+(\\.[a-zA-Z0-9_-])+/\r\n      if (regEmail.test(value)) {\r\n        return callback()\r\n      }\r\n      callback(new Error('请输入正确的邮箱!'))\r\n    }\r\n    var checkMobile = (rule, value, callback) => {\r\n      const regMobile = /^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/\r\n      if (regMobile.test(value)) {\r\n        return callback()\r\n      }\r\n      callback(new Error('请输入正确的手机号!'))\r\n    }\r\n    return {\r\n      queryInfo: {\r\n        query: '',\r\n        pagenum: 1,\r\n        pagesize: 2\r\n      },\r\n      userList: [],\r\n      total: 0,\r\n      switchValue: true,\r\n      dialogVisible: false,\r\n      editDialogVisible: false,\r\n      roleDialogVisible: false,\r\n      currentUserInfo: {},\r\n      selectedRoleID: '',\r\n      allRoles: [],\r\n      editForm: {},\r\n      addForm: {\r\n        username: '',\r\n        password: '',\r\n        email: '',\r\n        mobile: ''\r\n      },\r\n      editFormRules: {\r\n        email: [\r\n          { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n          { validator: checkEmail, trigger: 'blur' }\r\n        ],\r\n        mobile: [\r\n          { required: true, message: '请输入电话', trigger: 'blur' },\r\n          { validator: checkMobile, trigger: 'blur' }\r\n        ]\r\n      },\r\n      addFormRules: {\r\n        username: [\r\n          { required: true, message: '请输入用户名', trigger: 'blur' },\r\n          { min: 3, max: 10, message: '用户名长度在3~10字符之间', trigger: 'blur' }\r\n        ],\r\n        password: [\r\n          { required: true, message: '请输入密码', trigger: 'blur' },\r\n          { min: 3, max: 10, message: '密码长度在3~10字符之间', trigger: 'blur' }\r\n        ],\r\n        email: [\r\n          { required: true, message: '请输入邮箱', trigger: 'blur' },\r\n          { validator: checkEmail, trigger: 'blur' }\r\n        ],\r\n        mobile: [\r\n          { required: true, message: '请输入电话', trigger: 'blur' },\r\n          { validator: checkMobile, trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserList()\r\n  },\r\n  methods: {\r\n    closeRoleDialog() {\r\n      this.selectedRoleID = ''\r\n    },\r\n    async saveRole() {\r\n      if (!this.selectedRoleID) {\r\n        return this.$message.error('请选择要分配的角色!')\r\n      }\r\n      const { data: res } = await this.$axios.put(`users/${this.currentUserInfo.id}/role`, { rid: this.selectedRoleID })\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error('分配角色失败!')\r\n      }\r\n      this.$message.success('分配成功!')\r\n      this.roleDialogVisible = false\r\n      this.getUserList()\r\n    },\r\n    editUser() {\r\n      this.$refs.editFormRef.validate(async valid => {\r\n        if (!valid) {\r\n          this.$message.error('请输入有效的用户信息!')\r\n          return\r\n        }\r\n        const { data: res } = await this.$axios.put('users/' + this.editForm.id, { email: this.editForm.email, mobile: this.editForm.mobile })\r\n        if (res.meta.status !== 200) {\r\n          this.$message.error('更新用户信息失败!')\r\n        }\r\n        this.editDialogVisible = false\r\n        this.$message.success('更新用户信息成功!')\r\n        this.getUserList()\r\n      })\r\n    },\r\n    editDialogClose() {\r\n      this.$refs.editFormRef.resetFields()\r\n    },\r\n    addUser() {\r\n      this.$refs.addFormRef.validate(async valid => {\r\n        if (!valid) {\r\n          this.$message.error('请输入有效的用户信息!')\r\n          return\r\n        }\r\n        const { data: res } = await this.$axios.post('users', this.addForm)\r\n        if (res.meta.status !== 201) {\r\n          this.$message.error('添加用户失败!')\r\n        }\r\n        this.dialogVisible = false\r\n        this.$message.success('添加用户成功!')\r\n        this.getUserList()\r\n      })\r\n    },\r\n    addDialogClose() {\r\n      this.$refs.addFormRef.resetFields()\r\n    },\r\n    handleSizeChange(newSize) {\r\n      this.queryInfo.pagesize = newSize\r\n      this.getUserList()\r\n    },\r\n    handleCurrentChange(newPage) {\r\n      this.queryInfo.pagenum = newPage\r\n      this.getUserList()\r\n    },\r\n    async handleswitch(index, row) {\r\n      const { data: res } = await this.$axios.put(`/users/${row.id}/state/${row.mg_state}`)\r\n      console.log(res)\r\n      if (res.meta.status !== 200) {\r\n        row.mg_state = !row.mg_state\r\n        return this.$message.error('更新失败!')\r\n      }\r\n      return this.$message.success('更新成功!')\r\n    },\r\n    async showEditDialog(id) {\r\n      this.editDialogVisible = true\r\n      const { data: res } = await this.$axios.get(`users/${id}`)\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error('获取用户信息失败!')\r\n      }\r\n      this.editForm = res.data\r\n    },\r\n    handleDelete(id) {\r\n      this.$confirm('是否确认删除此用户?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async val => {\r\n        const { data: res } = await this.$axios.delete('users/' + id)\r\n        if (res.meta.status !== 200) {\r\n          this.$message.error('删除用户失败!')\r\n        }\r\n        this.$message.success('删除成功!')\r\n        this.getUserList()\r\n      })\r\n        .catch(err => console.log(err))\r\n    },\r\n    async handleSetting(row) {\r\n      this.currentUserInfo = row\r\n      this.roleDialogVisible = true\r\n      const { data: res } = await this.$axios.get('roles')\r\n      if (res.meta.status !== 200) {\r\n        return this.$message.error('获取角色列表失败!')\r\n      }\r\n      this.allRoles = res.data\r\n    },\r\n    async getUserList() {\r\n      const { data: list } = await this.$axios.get('users', {\r\n        params: this.queryInfo\r\n      })\r\n      console.log(list)\r\n      if (list.meta.status !== 200) {\r\n        return this.$message.error('获取用户列表失败!')\r\n      }\r\n      this.userList = list.data.users\r\n      this.total = list.data.total\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=573d80f2&scoped=true&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"573d80f2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}